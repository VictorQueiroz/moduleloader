!function(e){function t(e){return function(){var t=i(arguments),n=this.blocks[e];return n.push.apply(n,t),this}}function n(e,t){this.blocks={services:[],config:[],run:[]},this.name=e,this.dependencies=t}function o(e){this.loaded=[],this.modules={},this.injector=e}var r=window.injector.Injector,i=function(e){return Array.prototype.slice.call(e)};n.SERVICE="services",n.CONFIG="config",n.RUN="run",n.prototype={service:t("services"),config:t("config"),run:t("run"),boot:function(e){this.blocks;if(e instanceof r!=!0)throw new Error("The injector must be an instance of Injector");this.injector=e,this.execute("services")},execute:function(){var e,t,n,o=i(arguments);for(e=o.length-1;e>=0;e--)n=o[e],t={},t[n]=this.blocks[n],t[n]=this._blocks(t);return t},_blocks:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)this._block(t[n],e[t[n]]);return this},_block:function(e,t){for(var o,i,s=t.length-1;s>=0;s--){if(i=t[s],o=r.extractDeps(i),o.length>0)for(var c,h,u=0;u<o.length;u++)c=o[u],(h=t.indexOf(c))>-1&&(this.injector.pending[t[h]]=t[++h]);switch(e){case n.SERVICE:this.injector.pending[t[--s]]=i;break;default:this.injector.invoke(i)}}}},o.prototype={register:function(e,t){if(t){if(this.modules.hasOwnProperty(e))throw new Error('Error while trying to redefine "'+e+'"');return this.modules[e]=new n(e,t)}if(this.modules.hasOwnProperty(e))return this.modules[e];throw new Error('Module "'+e+'" does not exists')},load:function(e,t){t=t||[];var n,o=e.name,r=e.dependencies;t.push(o),e.boot(this.injector),this.loaded.push(e);for(var i=0;i<r.length;i++){if(!this.modules.hasOwnProperty(r[i]))throw new Error('Module "'+r[i]+'" does not exists as a dependency of "'+o+'"');if(n=this.modules[r[i]],t.indexOf(n.name)>-1)throw new Error("Circular dependency found: "+t.join(" <- ")+" <- "+n.name);this.load(n,t)}t.pop()},bootstrap:function(e){var t,n=this.loaded;this.load(this.register(e));for(var o=n.length-1;o>=0;o--)t=n[o],t.execute("config");for(var o=n.length-1;o>=0;o--)t=n[o],t.execute("run")}};var s={},c={};e.moduleloader=new o(new injector.Injector(s,c)),e.moduleloader.ModuleLoader=o}(window);