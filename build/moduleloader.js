!function(e){function t(e){return function(){var t=i(arguments),o=this.blocks[e];return o.push.apply(o,t),this}}function o(e,t){this.blocks={services:[],config:[],run:[]},this.name=e,this.dependencies=t}function n(e){this.loaded=[],this.modules={},this.injector=e}var r=window.injector.Injector,i=function(e){return Array.prototype.slice.call(e)};o.SERVICE="services",o.CONFIG="config",o.RUN="run",o.prototype={service:t("services"),config:t("config"),run:t("run"),boot:function(e){this.blocks;if(e instanceof r!=!0)throw new Error("The injector must be an instance of Injector");this.injector=e,this.execute("services")},execute:function(){var e,t,o,n=i(arguments);for(e=n.length-1;e>=0;e--)o=n[e],t={},t[o]=this.blocks[o],t[o]=this._blocks(t);return t},_blocks:function(e){for(var t=Object.keys(e),o=0;o<t.length;o++)this._block(t[o],e[t[o]]);return this},_block:function(e,t){for(var n,i,s=t.length-1;s>=0;s--){if(i=t[s],n=r.extractDeps(i),n.length>0)for(var c,h,u=0;u<n.length;u++)c=n[u],(h=t.indexOf(c))>-1&&(this.injector.pending[t[h]]=t[++h]);switch(e){case o.SERVICE:this.injector.pending[t[--s]]=i;break;default:this.injector.invoke(i)}}}},n.prototype={register:function(e,t){if(t){if(this.modules.hasOwnProperty(e))throw new Error('Error while trying to redefine "'+e+'"');return this.modules[e]=new o(e,t)}if(this.modules.hasOwnProperty(e))return this.modules[e];throw new Error('Module "'+e+'" does not exists')},load:function(e,t){t=t||[];var o,n=e.name,r=e.dependencies;t.push(n),e.boot(this.injector),this.loaded.push(e);for(var i=0;i<r.length;i++){if(!this.modules.hasOwnProperty(r[i]))throw new Error('Module "'+r[i]+'" does not exists as a dependency of "'+n+'"');if(o=this.modules[r[i]],t.indexOf(o.name)>-1)throw new Error("Circular dependency found: "+t.join(" <- ")+" <- "+o.name);this.load(o,t)}t.pop()},bootstrap:function(e){var t,o=this.loaded;this.load(this.register(e));for(var n=o.length-1;n>=0;n--)t=o[n],t.execute("config");for(var n=o.length-1;n>=0;n--)t=o[n],t.execute("run")}};var s={},c={};e.moduleloader=new n(new injector.Injector(s,c)),e.moduleloader.Module=o,e.moduleloader.ModuleLoader=n}(window);